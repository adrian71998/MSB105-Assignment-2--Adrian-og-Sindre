---
title: "Assignment 2 - Adrian og Sindre"
format: html
editor: visual
lang: "nb"
bibliography: kilder.bib
---

------------------------------------------------------------------------

## **1. Innledning**

I dette minipaperet skal vi se nærmere på forholdet mellom høyde og inntekt, og prøve å finne svar på om det er høyden som bestemmer inntekten vår, ved hjelp av datasettet Heights.
Besvarelsen vil starte med en generell literaturgjennomgang hvor vi ser nærmere på forholdet mellom inntekt og en rekke andre faktorer, blant annet bmi, sivilstatus, utdanning og kjønn.

Deretter vil oppgaven se nærmere på det aktuelle datasettet, og bruke deskribtive statistikker for å analysere sammenhenger mellom ulike faktorer, og knytte dette opp mot literaturgjennomgangen.
Videre brukes grafiske modeller for å studere andre relevante sammenhenger, får det til slutt skal konkluderes hvorvidt det er høyde som bestemmer inntekt.

### ***2. Literaturgjennomgang***

Denne delen av oppgaven vil benytte eksterne kilder, og gjøre rede for hva teori og forskning mener er sammenhengen mellom lønn og henholdsvis, høyde, bmi, sivilstatus, utdanning og kjønn.

##### Lønn og høyde

Ut fra literaturen kan det virke som det er en klar sammenheng mellom høyde og inntekt, og at dette kan være et resultat av både biologiske, sosiale og psykologiske faktorer.
**Anne Case** og **Christina Paxson** er blant de mener dette, og de mener hver tommer med høyde er assosiert med omtrent 2-2,5% økning i inntekt.
De peker blant annet på at høye personer gjør det bedre på kognitive tester som barn, og at dette legger et bedre utgangspunkt for karriere [@CasePaxson2006].
De samme forskerne mener også at i tillegg til bedre kognitive ferdigheter som barn, vil også høyde ofte gi høyere selvtilitt og andre personlige egenskaper som kan være avgjørendende for inntekt.

##### lønn og bmi

Det er forsket en del på sammenheng mellon BMI og inntekt, men på dette området er funnene noe mer splittet.
Det kan virke som om det er en negativ sammenheng mellom høy BMI og inntekt, og at dette er vesentlig tydeligere på kvinner, enn for menn [@Edwards2021].

##### Lønn og sivilstatus

Det er forsket en del på dette området, og det kan virke som gifte personer, spesielt menn tjener bedre enn ugifte personer.
Det er likevel en del naturlige forklaringer bak slike funn.
Vi ser ofte at inntekt øker med alder, og at det derfor ofte vil være en yngre gruppe vi studerer når vi ser nærmere på ugifte personer [@fed_stlouis_wage_ladder].

##### lønn og utdanning

Litteraturen viser en sterk positiv sammenheng mellom utdanning og inntekt, hvor høyere utdanning generelt fører til høyere lønn.
Jacob Mincers inntektsfunksjon illustrerer at hvert år med utdanning øker inntekten med omtrent 10 % globalt \[\@mincer1974schooling\].

##### lønn og kjønn

Når det kommer til kjønn, virker literaturen å være ganske samstemt.
Menn tjener bedre enn kvinner.
I følge Jennifer Cheeseman Day (2019), er forskjeller så stor at blant de med høyere utdanning tjener kvinner kun 74 cents for hver dollar menn tjener [@us_census_gender_earnings_gap].

### EDA analyse

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(forcats)
library(modelr)
library(flextable)
library(vtable)
library(labeling)
library(DescTools)

summary(heights)


#| lst-label: lst-read-in-data
#| lst-cap: "Kode for å lese inn data og definere noen nye variabler."
heights <- modelr::heights

heights <- heights %>% 
  mutate(
    bmi = weight * 0.4536/(height * 2.54/100)^2,
    married = fct_collapse(
      .f = marital,
      married = "married",
      other_level = "not married"
    ),
    edu_fac = cut(
      x = education,
      breaks = c(0, 12, 14, 16, 21),
      labels = c("not_hs", "not_cc", "not_col", "col_plus"),
      right = FALSE
    )
  ) |> 
  # reorganiserer data s.a. de fire faktor-variablerne kommer
  # lengst til høyre
  select(income:age, education:bmi, everything()) |>
  # Dropper marital og education siden disse ikke skal brukes
  select(-education, -marital)

# Inntekt lik 0
heightsZeroInc <- heights |> 
  filter(income == 0)
# «Normal» inntekt
heightsNormInc <- heights |> 
  filter(income > 0 & income < 343830)
heightsHighInc <- heights |> 
  filter(income == 343830)


```

Starter på EDA analyse

```{r}
# legger inn deskriptiv statistikk for høyde totalt
#| label: tbl-desc-stat
#| tbl-cap: "Deskreptiv statistikk for datasettet `modelr::heights`."
#| lst-label: lst-heights-st
#| lst-cap:
heights |> 
  #fjerner afqt da vi ikke har behov for det her
  select(-afqt) |>
  st(out = "return") |> 
  as_flextable(max_row = 20) |> 
  line_spacing(space = 0.3, part = "all") |> 
  fontsize(size = 9, part = "body") |> 
  fontsize(size = 10, part = "header") |> 
  width(width = 16, unit = "mm") |> 
  delete_part("footer")

```

```{r}
# Totalt antall manglende verdier i hele datasettet
total_missing <- heights %>%
  summarize_all(~ sum(is.na(.))) %>%
  summarise(total_missing = sum(across(everything()))) %>%
  pull(total_missing)

print(total_missing)
```

```{r}
#| label: tbl-height
#| caption: "Deskriptiv statistikk for høyde."
height_stats <- heights %>%
  summarise(
    Mean = mean(height, na.rm = TRUE),
    SD = sd(height, na.rm = TRUE),
    Min = min(height, na.rm = TRUE),
    Median = median(height, na.rm = TRUE),
    Max = max(height, na.rm = TRUE)
  )

print(height_stats)
```

```{r}
#| label: tbl-zeroInc
#| tbl-cap: "Deskriptiv statistikk for delsettet med ingen inntekt."
heights |>
  filter(income == 0) |>
  st(out = "return") |>
  as_flextable(max_row = 20) |>
  line_spacing(space = 0.3, part = "all") |>
  fontsize(size = 9, part = "body") |>
  fontsize(size = 10, part = "header") |>
  width(width = 16, unit = "mm") |>
  delete_part("footer")
```

```{r}
#|label: tbl-normInc
#| tbl-cap: "Deskriptiv statistikk for delsettet med normal inntekt."
heights %>%
  filter(income > 0 & income < 343830) %>%
  st(out = "return") %>%
  as_flextable(max_row = 20) %>%
  line_spacing(space = 0.3, part = "all") %>%
  fontsize(size = 9, part = "body") %>%
  fontsize(size = 10, part = "header") %>%
  width(width = 16, unit = "mm") %>%
  delete_part("footer")
```

```{r}
#| label: tbl-highInc
#| tbl-cap: "Deskriptiv statistikk for delsettet med høy inntekt."
heights %>%
  filter(income >= 343830) %>%
  st(out = "return") %>%
  as_flextable(max_row = 20) %>%
  line_spacing(space = 0.3, part = "all") %>%
  fontsize(size = 9, part = "body") %>%
  fontsize(size = 10, part = "header") %>%
  width(width = 16, unit = "mm") %>%
  delete_part("footer")
```

\@ref(tbl:height)

#### Forskjeller mellom de tre inntektsgruppene.

Når vi sammenligner de tre inntektsgruppene — null inntekt, normal inntekt, og høy inntekt — ser vi tydelige forskjeller på flere områder som høyde, vekt, sivilstatus, og utdanningsnivå.

For gruppen uten inntekt, med et gjennomsnitt på null inntekt, ser vi at gjennomsnittshøyden er 66 tommer og vekten er 187 lbs.
BMI ligger på et gjennomsnitt på 30, noe som indikerer en tendens til overvekt.
Det er også en høyere andel kvinner (57 %) i denne gruppen enn menn (43 %).
Når det gjelder sivilstatus, er 41 % av deltakerne gift, mens de resterende 59 % er ugifte.
Utdanningsnivået viser at kun 11 % har høyere utdanning, mens en stor del av gruppen (48 %) har ikke collegeutdanning.

I gruppen med normal inntekt er gjennomsnittlig inntekt 46,751.
Her ser vi en noe høyere gjennomsnittshøyde på 67 tommer, og en vekt på 188 lbs, som gir en BMI på 29.
Andelen personer som er gift, er 58 %, noe som indikerer at stabil sivilstatus kan være mer vanlig blant personer med en viss inntekt.
Når det gjelder utdanning, har 26 % av deltakerne høyere utdanning, mens 46 % ikke har collegeutdanning.
Dette tyder på at utdanning fortsatt spiller en viktig rolle i å nå dette inntektsnivået, men at det ikke nødvendigvis krever en fullført høyere grad.

For gruppen med høy inntekt, hvor gjennomsnittsinntekten er på hele 343,830, ser vi flere markante forskjeller.
Gjennomsnittlig høyde her er 71 tommer og vekten ligger på 195 lbs, noe som gir en BMI på 28.
Andelen som er gift, er svært høy (83 %), noe som kan tyde på at stabil sivilstatus og høy inntekt er nært knyttet sammen.
Utdanningsnivået er også betydelig høyere i denne gruppen, med hele 82 % som har fullført høyere utdanning.
Dette viser en klar sammenheng mellom høyere utdanning og høy inntekt.

Sammenlignet viser de tre inntektsgruppene tydelige mønstre når det gjelder fysisk karakteristikk, sivilstatus og utdanningsnivå.
De med høyere inntekt har en tendens til å være høyere, veie mer, og ha lavere BMI enn de i de lavere inntektsgruppene.
Videre er andelen gifte og andelen med høyere utdanning betydelig høyere i gruppen med høy inntekt, noe som tyder på at både stabil sivilstatus og utdanning er viktige faktorer for å oppnå høy inntekt.
Gruppen uten inntekt skiller seg ut med høyere andel kvinner og lavere utdanning, noe som kan tyde på økonomiske utfordringer knyttet til manglende utdanning og støtteapparat.
Dette gir et helhetlig bilde av hvordan økonomiske faktorer, demografi og utdanning henger sammen på tvers av disse tre gruppene.

*Går over til å splitte på kjønn*

```{r}
#| label: men-low-income
#| tbl-cap: "Deskriptiv statistikk for menn med null inntekt"
height_zero_inc_male <- heights |>
  filter(sex == 'male' & income ==0) |>
  st(out = "return") |>
  as_flextable(max_row = 20) |>
  line_spacing(space = 0.3, part = "all") |>
  fontsize(size = 9, part = "body") |>
  fontsize(size = 10, part = "header") |>
  width(width = 16, unit = "mm") |>
  delete_part("footer")
height_zero_inc_male
```

```{r}
#| label: female-low-income
#| tbl-cap: "Deskriptiv statistikk for kvinner med null inntekt"
heights_zero_inc_female <- heights %>%
  filter(sex == 'female' & income ==0) |>
  st(out = "return") |>
  as_flextable(max_row = 20) |>
  line_spacing(space = 0.3, part = "all") |>
  fontsize(size = 9, part = "body") |>
  fontsize(size = 10, part = "header") |>
  width(width = 16, unit = "mm") |>
  delete_part("footer")
heights_zero_inc_female
```

```{r}
#| label: men-norm-income
#| tbl-cap: "Deskriptiv statistikk for menn med normal inntekt"
heightsNormIncMale <- heightsNormInc %>%
  filter(sex == 'male') |>
  st(out = "return") |>
  as_flextable(max_row = 20) |>
  line_spacing(space = 0.3, part = "all") |>
  fontsize(size = 9, part = "body") |>
  fontsize(size = 10, part = "header") |>
  width(width = 16, unit = "mm") |>
  delete_part("footer")
heightsNormIncMale
```

```{r}
#| label: female-norm-income
#| tbl-cap: "Deskriptiv statistikk for kvinner med normal inntekt"
heightsNormIncFemale <- heightsNormInc %>%
  filter(sex == 'female') %>%
  st(out = "return") |>
  as_flextable(max_row = 20) |>
  line_spacing(space = 0.3, part = "all") |>
  fontsize(size = 9, part = "body") |>
  fontsize(size = 10, part = "header") |>
  width(width = 16, unit = "mm") |>
  delete_part("footer")
heightsNormIncFemale
```

```{r}
#| label: men-high-income
#| tbl-cap: "Deskriptiv statistikk for menn med høy inntekt"
heightsHighIncMale <- heightsHighInc %>%
  filter(sex == 'male') |>
  st(out = "return") |>
  as_flextable(max_row = 20) |>
  line_spacing(space = 0.3, part = "all") |>
  fontsize(size = 9, part = "body") |>
  fontsize(size = 10, part = "header") |>
  width(width = 16, unit = "mm") |>
  delete_part("footer")
heightsHighIncMale
```

```{r}
#| label: female-high-income
#| tbl-cap: "Deskriptiv statistikk for kvinner med høy inntekt"
heightsHighIncFemale <- heightsHighInc %>%
  filter(sex == 'female') |>
  st(out = "return") |>
  as_flextable(max_row = 20) |>
  line_spacing(space = 0.3, part = "all") |>
  fontsize(size = 9, part = "body") |>
  fontsize(size = 10, part = "header") |>
  width(width = 16, unit = "mm") |>
  delete_part("footer")
heightsHighIncFemale
```

Når vi sammenligner de seks gruppene, ser vi flere klare forskjeller.
Menn med lav inntekt har en gjennomsnittlig høyde på 70 tommer, mens kvinner har 64 tommer.
Menn veier i gjennomsnitt 202 lbs, mens kvinner veier 177 lbs.
BMI er høyere for kvinner (30) enn menn (29).
Andelen kvinner som er gift er 51 %, mot 30 % for menn.
Kvinner har også høyere andel med utdanning (13 % mot 8 %).

For normal inntekt er menns gjennomsnittlige inntekt 54,236, mens kvinner ligger på 39,472.
Menn er høyere (70 tommer) og tyngre (205 lbs) enn kvinner (64 tommer, 172 lbs).
Begge gruppene har lik BMI (29).
62 % av mennene og 54 % av kvinnene er gift.
Utdanningsnivået er noe høyere blant kvinner (29 % mot 23 %).

For høy inntekt er menn igjen høyere (71 tommer) og tyngre (199 lbs) enn kvinner (65 tommer, 150 lbs).
83 % av kvinnene og 82 % av mennene er gift.
Høy utdanning er vanlig, med 81 % av mennene og 92 % av kvinnene som har fullført.

Totalt ser vi tydelige mønstre når det gjelder fysisk karakteristikk, sivilstatus og utdanningsnivå, som påvirkes av kjønn.
Menn har høyere inntekter, større høyde og vekt, mens kvinner har høyere andel som er gift og høyere utdanning, spesielt i lav- og normalinntektsgruppene.
Høy inntekt korrelerer med høyere utdanning for begge kjønn.

Basert på datasettet med normal inntekt, kan vi identifisere noen interessante sammenhenger mellom variablene.
Vi ser at den gjennomsnittlige høyden i denne gruppen er 67 tommer, og at gjennomsnittlig vekt er 188 lbs, med en BMI på 29.
Dette indikerer at både menn og kvinner i denne gruppen i gjennomsnitt ligger nær grensen for overvekt, noe som kan være relevant når vi diskuterer helseaspekter i relasjon til inntekt.

Når vi ser på sivilstatus, finner vi at 58 % av personene med normal inntekt er gift, med omtrent like stor andel menn og kvinner.
Dette kan tyde på at inntektsnivået har en viss sammenheng med stabil sivilstatus, hvor gifte par er relativt likt fordelt på tvers av kjønn.
Andelen personer med høyere utdanning er 26 %, som indikerer at en fjerdedel av gruppen har fullført høyere utdanning.
Dette er en faktor som også kan være med på å forklare lønnsnivået, siden høy utdanning ofte er korrelert med høyere inntekt, selv innenfor en relativt homogen inntektsgruppe.

Et annet interessant funn er at det er en relativt stor forskjell i utdanningsnivå innen normalinntektsgruppen.
Mens 46 % av deltakerne har noe collegeutdanning, har kun 26 % høyere utdanning.
Dette kan tyde på at høyere utdanning gir en fordel for å nå høyere inntektsnivåer, men at mange også klarer seg på dette nivået med mindre enn fullført collegeutdanning.

Oppsummert viser datasettet med normal inntekt at det er klare sammenhenger mellom variabler som høyde, vekt, sivilstatus og utdanningsnivå.
Personer i denne gruppen har gjennomgående lik høyde og vekt, og en stor andel er gift.
Utdanningsnivå varierer derimot betydelig, og det kan være interessante diskusjoner rundt hvordan dette påvirker økonomiske og sosiale utfall innen denne gruppen.

#### Samsvarer det som fremkommer fra den deskrivptive statistikken med funnene fra literaturen?

Når det kommer til høyde kan det ut fra den deskribtive statistikken vår virke som om literaturen har rett når det kommer til høyde.
I modellene hvor henholdsvis nullintekt, normal inntekt og høy inntekt er filtrert ut ser vi at høyden øker noe for hver kategori.
Likevel må det nevnes at andelen menn øker i for hver gruppe, og flere menn vil også dra opp gjennomsnittshøyden.
Splittet på kjønn virker det som høyden er mindre avgjørende, på tross av at gjennomsnittet er noe høyere for begge kjønn blant de som tjener best.

I litteraturen kom det frem at det var noe vage sammenhenger mellom BMI og inntekt.
Men utfra den deskribtive statistikken vår kan det se ut som om litteraturen har rett i at økning i BMI kan ha negativ påvirkning på inntekt, spesielt for kvinner.

Utfra statistikken er det også åpenbart at utdanning spiller en viktig rolle for inntekt.
Dette viser igjen i fordelingen av utdanning for de med henholdsvis nullinntekt, normal inntekt og høy inntekt.
Blant de som tjener best er andelen med høyere utdanning svært høy.
Dette samsvarer også bra med informasjonen fra literaturdelen.

Når det kommer til sammenhengen mellom kjønn og inntekt, ser vi at tabellene våre indikerer akkurat det samme som literaturen, at menn generelt har høyere inntekt enn kvinner.
Dette gjenspeiles både i at kvinner er overrepresentert blant de med null-innteker, samt at kun 12 kvinner er blant de 147 med høyest inntekt

#### Visualisering

```{r}
#| label: fig-norm-inc
#| fig-cap: "Plot av inntekt mot høyde. Fra den sorte modell-linjen som er
#| lagt inn ser vi at det ser ut til å være en positiv sammenheng
#|  mellom høyde og inntekt. Det er også lagt inn seperate modell-linjer for kvinner og menn Vi merker oss at sammenhengen mellom høyde og inntekt virker mindre når kjønn hensyntas i modell-linjene."
#| lst-label: lst-norm-inc-plot
#| lst-cap: "Kode for å generere «scatterplot» vha. `ggplot2`."
heightsNormInc  |> 
  ggplot(
  mapping = aes(
    x = height,
    y = income,
    color = sex
    )
  ) + 
  geom_jitter(
    size = 1,
    alpha = 0.40
    ) +
  geom_smooth(
    formula = y ~ x,
    method = "lm",
    colour = "black",
    lwd = 0.75,
    se = FALSE
    ) +
  geom_smooth(
    aes(colour = sex),
    formula = y ~ x,
    method = "lm",
    lwd = 0.75,
    se = FALSE)
 

```

Plottet \@1st-fig-norm-inc over forteller oss en rekke ting, og bekrefter en del av observasjonene som er diskutert tidligere i paperet.
Fargene på observasjoene bekrefter det vi allerede vet, at menn generelt er høyere enn kvinner, og at flere menn enn kvinner har høy inntekt.
Den sorte modell-linjen forteller oss i utgangspunktet at det virker å være en positiv sammengeng mellom høyde og inntekt.
De rød og blå linjene viser også sammenheng mellom høyde og inntekt, men for henholdsvis menn og kvinner.
Vi ser da at sammenhengen ikke er like tydelig, akkurat som diskutert tidligere i oppgaven.

```{r}
heightsNormInc %>%
  ggplot(
    mapping = aes(
      x = income
      )
    ) +
  geom_histogram(
    bins = 30)

heightsNormInc %>%
  ggplot(
    mapping = aes(
      x = height
      )
    ) +
  geom_histogram(
    bins = 30)


heightsNormInc %>%
ggplot(aes(
  x = income)
  ) +
  geom_histogram(aes(
    y = ..density..),
    bins = 30,
    fill = "green",
    alpha = 0.6,
    color = "black"
    ) + 
  geom_density(
    color = "red",
    size = 1
    ) + 
  labs(title = "Fordeling av inntekt",
       x = "Inntekt",
       y = "Tetthet") +
  theme_minimal()
```

```{r}
#| label: fig-BMI-income
#| fig-cap: "Korrelasjon mellom BMI og inntekt"
# ønsker å bruke pairs for å sammenligne inntekt og høyde
pairs(select(heightsNormInc, income, height))

pairs(select(heightsNormInc, bmi, income))
```

```{r}
#| label: fig-sex-income
#| fig-cap: "Viser fordeling av inntekt mellom menn og kvinner i populasjonsutvalget"
heights %>% 
  ggplot(mapping = aes(x = income, fill = sex, colour = sex)) +
  geom_density(alpha = 0.2, na.rm = TRUE) + 
  facet_wrap(~sex)
```

```{r}
#| label: fig-height-edufac
#| fig-cap: "Boksplot av utdanning mot høyde. Modellen er splittet på kjonn og viser menn til venstre, og kvinner til høyre. Det kan virke som det er en positiv sammenheng mellom høyde og utdanningsnivå både for kvinner og menn"

heights %>%  
ggplot(mapping = aes(x = edu_fac, y = height)) +
facet_wrap(~sex) + 
geom_boxplot()
```

Utfra det vi har sett tidligere, både i teoridelen og i den deskriptive statistikken, kan det tyde på at utdanning er en svært viktig faktor for inntekt.
Den er derfor interessant å sjekke nærmere og høyde kan ha betydning for utdanningsnivå.
Vi lager derfor en boxplit som viser utdanning i forhold til høyde, og facer denne mht kjønn.

mrk: høyde ser ut til å påvirke utdanning en del, og videre ser vi at utdanning i stor grad preger inntekt.

```{r}
heights %>%  
ggplot(mapping = aes(x = edu_fac, y = income)) +
facet_wrap(~sex) + 
geom_boxplot()
```

Notat boxplotter: Utdanning har definitivt innvirkning på inntekt.

Og høyde virker også å spille inn på inntekt.

```{r}
#| label: fig-height-inc-edu
#| fig-cap: "Sammenheng mellom inntekt og høyde, skiller på utdanning og kjønn"
ggplot(data = heights,
       aes(
         x = height,
         y = income,
         color = sex)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue", linetype = "dashed") +  # Legger til en lineær trendlinje
  labs(
    x = "Hoyde (cm)",
    y = "Inntekt (NOK)"
  ) +
  theme_minimal() +
  facet_wrap(~ edu_fac)
```

Det kan virke som om høyde spiller en større rolle desto høyere utdanning man har.

```{r}
#| label: height-inc-sex
#| fig-cap: "Modellen ser på sammenheng mellom høyde og inntekt med et skille på kjønn"
ggplot(data = heights,
       aes(
         x = height,
         y = income,
         color = sex)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue", linetype = "dashed") +  # Legger til en lineær trendlinje
  labs(
    x = "Hoyde (cm)",
    y = "Inntekt (NOK)"
  ) +
  theme_minimal() +
  facet_wrap(~ sex)
```
